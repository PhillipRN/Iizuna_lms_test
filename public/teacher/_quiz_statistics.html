<!doctype html>
<html lang="ja">
<head>
    {include file='_gtag.html'}
    <meta charset="utf-8">
    <meta name="robots" content="noindex">
    <title>IIZUNA Test Creator</title>

    {include file='_favicon.html'}

    <link rel="stylesheet" href="../common/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="../common/styles/quiz.css?202201231800">
    <style>
        .bar {
            background-color: #2a333b;
        }
        .correct_bar {
            background-color: #349e67;
        }
        .bar, .correct_bar {
            height: 28px;
        }
        h3 {
            font-size: 18px;
        }
    </style>
</head>
<body>
<div id="contents">
    <div id="header">
        <img src="../common/images/iizunalogo.png" alt="iizunalogo" width="" height="50px" >
    </div>

    <h1 style="margin-top: 20px">分析</h1>

    <a href="download_statistics_students.php?id={$id}" download="{$title} Quiz Student Analysis Report.csv" class="btn btn-secondary mb-3">受講生分析</a>
    <a href="download_statistics_items.php?id={$id}" download="{$title} Quiz Item Analysis Report.csv" class="btn btn-secondary mb-3">アイテム分析</a>

    <h2>{$title}</h2>
    <div style="margin-bottom: 20px;">
        <input type="radio" name="sort" onclick="location.href='quiz_statistics.php?quiz_id={$id}'" id="sort_none" {if empty($sort)}checked{/if}> <label for="sort_none">ソートなし</label>　
        <input type="radio" name="sort" onclick="location.href='quiz_statistics.php?quiz_id={$id}&sort=correct'" id="sort_correct" {if $sort=="correct"}checked{/if}> <label for="sort_correct">正当率が高い問題順</label>　
        <input type="radio" name="sort" onclick="location.href='quiz_statistics.php?quiz_id={$id}&sort=incorrect'" id="sort_incorrect" {if $sort=="incorrect"}checked{/if}> <label for="sort_incorrect">誤答率が高い問題順</label>
    </div>
    {if !empty($statisticsData)}

    {assign var=part_id value=0}
    {foreach $pageData as $quiz name='loop'}

    {if $quiz.part_id != $part_id || !empty($sort)}
    {assign var=part_id value=$quiz.part_id}
    <b>{$quiz.part_text}</b>
    {/if}
    <p>（{$quiz.question_id}）{$quiz.question_text}</p>
    <table class="table table-bordered" >
        {foreach $statisticsData.statisticsData[$quiz.question_id] as $statistics name='loop_statistics'}
        <tr {if $statistics.isCorrect}class="table-success"{/if}>
            <td {if $statistics.isCorrect}class="text-success"{/if}>{if $statistics.answer != ''}{$statistics.answer}{else}解答なし{/if}</td>
            <td style="width: 15%" {if $statistics.isCorrect}class="text-success"{/if}>{if $statistics.answerCount != 0}{$statistics.answerCount}回答者{/if}</td>
            <td style="width: 15%" {if $statistics.isCorrect}class="text-success"{/if}>{$statistics.rate}%</td>
            <td style="width: 30%"><div class="{if $statistics.isCorrect}correct_bar{else}bar{/if}" style="width:{$statistics.rate*3+5}px;"></td>
        </tr>
        {/foreach}
    </table>

    {/foreach}

    {else}
    <div style="margin-top: 20px;">
        まだ誰も回答していません。
    </div>
    {/if}

    <hr />
    <div style="margin-bottom: 40px;">
        <a href="./">一覧へ</a>
    </div>
</div>

</body>
</html>
