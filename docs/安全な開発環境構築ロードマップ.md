# 安全な開発環境構築ロードマップ

## 🎯 あなたの状況

- ✅ 既存の開発環境（spapp-dev-ec2）は**触りたくない**
- ✅ システムを理解してから本番環境に臨みたい
- ✅ 安全に学習できる環境が欲しい

**完璧なアプローチです！** 段階的に進めましょう。

---

## 📅 推奨ロードマップ（4週間）

### **Week 1: ローカル環境でシステム理解** 🟢 安全度: 100%

#### 目標
- コードベースの構造を理解
- データベーススキーマを把握
- 基本的な機能の動作確認

#### 作業内容

```bash
# Day 1: 環境構築（30分）
cd /Users/phillipr.n./Documents/KUTO/いいずな/iizuna_apps_dev/iizuna-lms-main
make setup

# Day 2-3: システム探索（各2時間）
# - データベーススキーマの確認（phpMyAdmin）
# - 既存機能の動作確認
# - コードリーディング

# Day 4-5: 小さな修正を試す（各2時間）
# - CSSの変更
# - 表示テキストの変更
# - バリデーションルールの追加

# Day 6-7: テスト実行とデバッグ（各2時間）
make test
# - PHPUnit テストの理解
# - エラーハンドリングの確認
```

#### チェックポイント
- [ ] Docker環境が正常に起動する
- [ ] データベース構造を理解した
- [ ] 主要な機能（先生・生徒・クイズ）の流れを把握
- [ ] 小規模な修正ができる

---

### **Week 2: ドキュメント作成と理解の深化** 🟢 安全度: 100%

#### 目標
- システムアーキテクチャの理解
- 依存関係の把握
- デプロイフローの理解

#### 作業内容

```bash
# Day 8-10: ドキュメント作成
# - システム構成図を作成
# - データフロー図を作成
# - API仕様を確認・整理

# Day 11-12: 既存コードの分析
# - 主要なコントローラーの理解
# - モデルとデータベースの関係
# - 外部サービス連携の仕組み

# Day 13-14: 機能追加の練習
# - 新しいテーブルの追加
# - 簡単なCRUD機能の実装
# - API エンドポイントの追加
```

#### チェックポイント
- [ ] システム構成図が完成
- [ ] 主要なビジネスロジックを理解
- [ ] ローカル環境で新機能が追加できる
- [ ] Git操作に慣れた

---

### **Week 3: AWS環境の理解（触らない）** 🟡 安全度: 100%（見るだけ）

#### 目標
- AWS構成を理解
- デプロイフローを把握
- 本番環境との違いを認識

#### 作業内容

```bash
# Day 15-16: AWSドキュメントの確認
# - ReadMe.mdのデプロイ手順を読む
# - AWS構成図を作成
# - EC2/RDS/DynamoDBの役割を理解

# Day 17-18: 既存環境の観察（読み取り専用）
# - AWSコンソールで既存リソースを確認
# - 設定値を記録（触らない！）
# - セキュリティグループの理解

# Day 19-20: デプロイ手順の理解
# - AMI作成フローの把握
# - Auto Scalingの仕組み
# - デプロイチェックリストの作成

# Day 21: リスク分析
# - 何が危険か理解する
# - ロールバック手順の確認
# - 緊急時の連絡先確認
```

#### チェックポイント
- [ ] AWS構成図が完成
- [ ] デプロイフローを理解
- [ ] 既存環境に**一切触っていない**
- [ ] リスクと対策を把握

---

### **Week 4: 検証環境での実践** 🟡 安全度: 95%

#### 目標
- 必要に応じてAWS複製環境を作成
- 本番と同じフローでデプロイ練習
- 自信を持って本番対応できる準備

#### 作業内容

```bash
# Day 22-23: AWS複製環境の作成（オプション）
# - AMIから新しいインスタンスを起動
# - 設定ファイルの調整
# - 動作確認

# Day 24-25: デプロイ練習
# - ローカルで開発
# - Gitにプッシュ
# - 複製環境にデプロイ
# - 動作確認

# Day 26-27: トラブルシューティング練習
# - わざとエラーを起こす
# - ログの確認方法を習得
# - ロールバック手順の実践

# Day 28: 最終レビュー
# - 学んだことの整理
# - 本番対応チェックリスト作成
# - 不明点の洗い出し
```

#### チェックポイント
- [ ] 複製環境でデプロイができる
- [ ] トラブルシューティングができる
- [ ] 本番デプロイの手順を暗記
- [ ] 自信を持って本番対応できる

---

## 🚦 環境別の安全度とリスク

### ローカルDocker環境 🟢
**安全度: 100% | リスク: ゼロ**

- ✅ 既存環境に一切影響なし
- ✅ 何度でも作り直せる
- ✅ 失敗しても問題なし
- ✅ コストゼロ

**推奨期間**: 2-4週間（十分に理解するまで）

### AWS複製環境 🟡
**安全度: 95% | リスク: 低**

- ⚠️ 新しいリソースを作成（費用発生）
- ⚠️ 間違えて既存環境を触るリスク
- ✅ 本番と同じ構成
- ✅ 外部サービス連携テスト可能

**推奨期間**: 1-2週間（本番デプロイ前）

### 既存開発環境（spapp-dev-ec2） 🟠
**安全度: 70% | リスク: 中**

- ⚠️ 他の開発者も使用している可能性
- ⚠️ 設定ミスで動かなくなるリスク
- ✅ 本番と完全に同じ構成
- ✅ 追加コストなし

**推奨期間**: 理解が深まってから（4週間以降）

### 本番環境 🔴
**安全度: 30% | リスク: 高**

- ❌ サービス停止のリスク
- ❌ データ損失のリスク
- ❌ ユーザー影響あり
- ✅ 最終的な動作確認

**推奨期間**: 完全に理解・テスト完了後のみ

---

## 📊 今すぐできること vs 後でやること

### ✅ 今すぐできること（Week 1-2）

```bash
# 1. ローカルDocker環境を起動
cd /Users/phillipr.n./Documents/KUTO/いいずな/iizuna_apps_dev/iizuna-lms-main
make setup

# 2. システムを探索
open http://localhost:8080
open http://localhost:8081  # phpMyAdmin

# 3. コードを読む
code .  # VSCodeで開く

# 4. 小さな変更を試す
# - CSSの色を変える
# - エラーメッセージを変える
# - デバッグログを追加

# 5. テストを実行
make test
```

### ⏰ 後でやること（Week 3-4）

```bash
# 理解が深まってから：

# 1. AWSコンソールで既存環境を**見る**だけ
# 2. AWS複製環境の作成を検討
# 3. デプロイ練習
# 4. 本番対応
```

---

## 🎓 学習順序（優先度順）

### 優先度：高 🔥

1. **データベーススキーマの理解**
   - テーブル構造
   - リレーション
   - インデックス

2. **主要な機能フロー**
   - ログイン・認証
   - クイズ配信
   - 成績管理

3. **設定ファイルの理解**
   - config.ini の各項目
   - 環境による違い

### 優先度：中 ⭐

4. **外部サービス連携**
   - DynamoDB（トークン管理）
   - Firebase（プッシュ通知）
   - 外部API

5. **デプロイフロー**
   - Git操作
   - AMI作成
   - Auto Scaling

### 優先度：低 💡

6. **詳細な実装**
   - 個別のヘルパー関数
   - フロントエンドの詳細
   - バッチ処理の詳細

---

## 🛡️ 安全に作業するためのルール

### ✅ やって良いこと

- ✅ ローカルDocker環境で**何でも試す**
- ✅ コードを**読む・分析する**
- ✅ AWSコンソールで**見る**（編集しない）
- ✅ ドキュメントを**作成・整理する**
- ✅ 質問を**たくさんする**

### ❌ やってはいけないこと（Week 1-3）

- ❌ 既存の開発環境に**SSH接続する**
- ❌ 本番環境のAWSリソースに**触る**
- ❌ 既存のデータベースに**直接接続する**
- ❌ Gitの本番ブランチに**直接プッシュする**
- ❌ **分からないまま**本番操作する

---

## 💡 効率的な学習のコツ

### 1. ドキュメント作成を習慣に

理解したことを必ず文書化：

```markdown
# 学習ログ（日付）

## 今日理解したこと
- データベースのteacherテーブルの構造
- 先生の登録フロー

## まだ分からないこと
- DynamoDBへのトークン保存タイミング

## 次回やること
- 生徒登録フローの確認
```

### 2. 小さな成功体験を積む

```bash
# ❌ いきなり大規模な機能追加
# ✅ 小さな変更から始める

# 例：
# 1. ボタンの色を変える
# 2. エラーメッセージを変更
# 3. バリデーションを追加
# 4. 小さな機能を追加
```

### 3. 質問リストを作る

```markdown
# 質問リスト

## 技術的な質問
- [ ] DynamoDBのTTL設定はどこで？
- [ ] Firebase認証ファイルはどこで取得？

## 運用的な質問
- [ ] デプロイの承認者は誰？
- [ ] 緊急時の連絡先は？

## ビジネスロジックの質問
- [ ] LMSコードの発行ルールは？
- [ ] 有料・無料の違いは？
```

---

## 📞 困った時のエスカレーション

### レベル1: 自分で解決（30分以内）

```bash
# ログを確認
make logs

# ドキュメントを確認
cat docs/開発環境構築ガイド.md

# Google検索
```

### レベル2: AIに質問（1時間以内）

```
「〇〇の機能で△△というエラーが出ます。
ローカルDocker環境で動作確認中です。
ログは以下の通りです...」
```

### レベル3: チームに質問（その日のうち）

- 前任者（いれば）
- AWSの管理者
- 技術サポート

### レベル4: 専門家に相談（緊急時）

- AWSサポート
- 外部コンサルタント

---

## ✅ Week 1 開始前チェックリスト

作業開始前に確認：

- [ ] Docker Desktop がインストール済み
- [ ] プロジェクトを git clone 済み
- [ ] `QUICKSTART.md` を読んだ
- [ ] 既存環境を**触らない**と心に決めた
- [ ] 焦らず段階的に進めることを理解した

**準備ができたら：**

```bash
cd /Users/phillipr.n./Documents/KUTO/いいずな/iizuna_apps_dev/iizuna-lms-main
make setup
```

---

## 🎉 ゴール（4週間後）

以下ができるようになっている：

- ✅ システムの全体像を理解
- ✅ ローカル環境で開発・テストができる
- ✅ AWS構成を理解している
- ✅ デプロイ手順を暗記している
- ✅ 自信を持って本番対応できる

**焦らず、楽しみながら学習してください！**

---

## 📚 参考ドキュメント

- [QUICKSTART.md](../QUICKSTART.md) - 最速起動ガイド
- [開発環境構築ガイド.md](開発環境構築ガイド.md) - 詳細ガイド
- [AWS開発環境複製手順.md](AWS開発環境複製手順.md) - AWS複製方法
- [ReadMe.md](../ReadMe.md) - 本番デプロイ手順
- [API.md](../API.md) - API仕様書

---

**あなたのアプローチは完璧です。既存環境を守りながら、安全に学習していきましょう！**

